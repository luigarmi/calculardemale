<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Predicciones Clinicas - Proyecto Final</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="app-header">
        <div class="container header-shell">
            <div class="brand-block">
                <div class="brand-icon">HC</div>
                <div>
                    <h1>DEMALE Clinical Predictor</h1>
                </div>
            </div>
            <div class="badge-rack">
                <span class="badge">Multiclase</span>
                <span class="badge">Regresion Logistica</span>
                <span class="badge">Red Neuronal</span>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="hero-card">
            <div>
                <h2>Asistente de prediccion clinica</h2>
                <p>Pensado para personal no especialista. Elige la modalidad, completa los datos guiados y recibe la probabilidad de Dengue, Malaria o Leptospirosis.</p>
                <ul>
                    <li>Modelos validados con pipeline reproducible y escalado de variables.</li>
                    <li>Metricas multiclase para comparar exactitud, precision, recall y F1.</li>
                    <li>Matriz de confusion descargable y vista previa de los registros procesados.</li>
                </ul>
            </div>
            <div class="hero-stats">
                <div class="stat-block">
                    <span class="stat-label">Clases activas</span>
                    <span class="stat-value" id="hero-class-count">3</span>
                    <small>Diagnosticos disponibles</small>
                </div>
                <div class="stat-block">
                    <span class="stat-label">Variables de entrada</span>
                    <span class="stat-value" id="hero-feature-count">56</span>
                    <small>Auto-cargadas desde el backend</small>
                </div>
            </div>
        </section>

        <section class="card tab-card">
            <header>
                <h2>Selecciona el tipo de prediccion</h2>
                <p>Alterna entre evaluar un archivo completo o digitar un caso individual. Las ayudas visuales y rangos te acompanaran en cada pestana.</p>
            </header>
            <div class="tab-toolbar">
                <button type="button" class="tab-btn active" data-tab-target="batch-section">Prediccion por lotes</button>
                <button type="button" class="tab-btn" data-tab-target="individual-section">Caso individual</button>
            </div>
        </section>

        <section class="card card-highlight tab-pane active" id="batch-section">
            <header>
                <h2>Prediccion por lotes</h2>
                <p>Sube un archivo .csv o .xlsx con las columnas requeridas y la columna objetivo <code>diagnosis</code>. Obtendras matriz de confusion, metricas y vista previa.</p>
            </header>
            <form id="batch-form" class="form-grid" enctype="multipart/form-data">
                <div class="form-row">
                    <label for="batch-model">Modelo</label>
                    <select id="batch-model" name="model"></select>
                </div>
                <div class="form-row">
                    <label for="batch-file">Archivo de datos</label>
                    <input type="file" id="batch-file" name="file" accept=".csv,.xlsx,.xls" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="primary-btn">Procesar lote</button>
                    <span id="batch-status" class="status-msg"></span>
                </div>
            </form>
            <div id="batch-result" class="result-panel hidden">
                <div class="metrics-grid" id="batch-metrics"></div>
                <div class="confusion-wrapper">
                    <h3>Matriz de confusion</h3>
                    <img id="confusion-image" alt="Matriz de confusion" />
                    <table id="confusion-table"></table>
                </div>
                <div>
                    <h3>Vista previa (primeros 10 registros)</h3>
                    <div class="table-scroll">
                        <table id="batch-preview"></table>
                    </div>
                </div>
            </div>
        </section>

        <section class="card tab-pane hidden" id="individual-section">
            <header>
                <h2>Prediccion individual</h2>
                <p>Responde las preguntas guiadas. Los campos muestran rangos sugeridos para evitar valores fuera de contexto.</p>
            </header>
            <form id="individual-form" class="form-grid">
                <div class="form-row">
                    <label for="individual-model">Modelo</label>
                    <select id="individual-model" name="model"></select>
                </div>
                <div id="feature-inputs" class="feature-sections"></div>
                <div class="form-actions">
                    <button type="submit" class="primary-btn">Predecir</button>
                    <span id="individual-status" class="status-msg"></span>
                </div>
            </form>
            <div id="individual-result" class="result-panel hidden"></div>
        </section>

        <section class="card" id="reference-section">
            <header>
                <h2>Metricas de referencia</h2>
                <p>Resultados obtenidos al entrenar con el dataset clinico multiclase proporcionado por el docente.</p>
            </header>
            <div id="reference-content" class="metrics-grid"></div>
            <div class="legend-block">
                <h3>Enfermedades cubiertas</h3>
                <div id="class-legend" class="legend-grid"></div>
            </div>
        </section>
    </main>

    <footer class="app-footer">
        <div class="container">
            <small>Proyecto desarrollado aplicando los temas vistos en clase: limpieza, modelos lineales, redes neuronales, evaluacion multiclase y matrices de confusion.</small>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='app.js') }}" defer></script>
</body>
</html>
